!function(e){var t={};function i(l){if(t[l])return t[l].exports;var n=t[l]={i:l,l:!1,exports:{}};return e[l].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,l){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(l,n,function(t){return e[t]}.bind(null,n));return l},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);document.addEventListener("DOMContentLoaded",()=>{new class{constructor(e){this.config=Object.assign({input:null,decimals:0,onFileSelect:null,onProgress:null,onLoaded:null},e),this.bind()}bind(){this.config.input||console.warn("no input !"),this.config.input.addEventListener("change",e=>{e.target.files.length&&this.handleFileSelect(e.target.files[e.target.files.length-1])})}handleFileSelect(e){this.config.onFileSelect&&this.config.onFileSelect(e),this.readFile(e)}readFile(e){let t=new FileReader;t.onprogress=(e=>{this.config.onProgress&&this.config.onProgress({loaded:e.loaded,total:e.total,percent:100*Math.floor(e.loaded/e.total*Math.pow(10,this.config.decimals+2))/Math.pow(10,this.config.decimals+2)+"%"})}),t.onloadend=(e=>{e.target.readyState==FileReader.DONE&&this.config.onLoaded&&this.config.onLoaded(e.srcElement.result)}),t.readAsBinaryString(e)}onFileSelect(e){return this.config.onFileSelect=e,this}onProgress(e){return this.config.onProgress=e,this}onLoaded(e){return this.config.onLoaded=e,this}}({input:inputFile}).onFileSelect(()=>{progressBar.classList.remove("invisible")}).onProgress(e=>{progressBar.children[0].style.width=e.percent,progressBar.children[0].innerHTML=e.percent}).onLoaded(e=>{progressBar.classList.add("invisible");let t=new class{constructor(e){this.config=Object.assign({data:null,eol:"\n",eolToken:"EOLEOLEOL",separator:";",textDelimiter:'"',isFirstLineFieldName:!0,offset:0,limit:20},e),this.init(),this.do()}init(){this.fields=[],this.rows=[],this.config.separator=this.guessSeparator()}guessSeparator(){let e=0,t=null;return[",",";"].map(i=>{let l=this.config.data.split(i).length;l>e&&(e=l,t=i)}),t}do(){this.config.isFirstLineFieldName&&this.getFields(),this.getRows()}getFields(){let e=this.config.data.split(this.config.eol)[0];this.fieldLine=e,this.fields=this.fieldLine.split(this.config.separator);let t=[];this.fields.map(e=>{""==e&&(e="_"),t.includes(e)&&(e+="("+t.join("").split(e).length+")"),t.push(e)}),this.fields=t}getRows(){let e=this.config.data.match(new RegExp(`${this.config.separator}${this.config.textDelimiter}[^${this.config.separator}]*\n.*?${this.config.textDelimiter}${this.config.separator}`,"g"));e&&e.map(e=>{this.config.data=this.config.data.replace(e,e.replace(new RegExp("\n","g"),this.config.eolToken))}),this.config.data.split(this.config.eol).map(e=>{e!=this.fieldLine&&this.addRow(e)})}addRow(e){let t=e.split(this.config.separator),i={};this.fields.map((e,l)=>{let n=t[l];"string"==typeof n&&(n=n.replace(new RegExp(this.config.eolToken,"g"),"\n")),i[e]=n}),this.rows.push(i)}renameField(e,t){let i=this.fields.indexOf(e);this.fields[i]=t,this.rows.map(i=>{i[t]=i[e],delete i[e]})}addField(e){this.fields.push(e),this.rows.map(t=>{t[e]=""})}deleteField(e){let t=this.fields.indexOf(e);this.fields.splice(t,1),this.rows.map(t=>{delete t[e]})}replaceValues(e,t,i){this.rows.map(l=>{l[e]?l[e]=l[e].replace(new RegExp(t),i):t.length||(l[e]=i)})}htmlController(){let e=document.createElement("table");e.className="table tabler";var t=document.createElement("thead"),i=document.createElement("tr");let l=document.createElement("div");l.className="head-controls input-group";let n=document.createElement("button");n.className="icon btn btn-light",n.innerHTML="+";let a=document.createElement("input");a.className="form-control",a.value="",a.placeholder="New field, or new fields separated by separator",l.appendChild(n),l.appendChild(a),e.appendChild(t),t.appendChild(l),t.appendChild(i);var r=document.createElement("tbody");e.appendChild(r),n.addEventListener("click",()=>{a.value.split(this.config.separator).map(e=>{this.addField(e),s(e)}),this.reloadTable()});let s=e=>{let t=document.createElement("th"),l=document.createElement("input");l.classList.add("form-control"),l.value=e,l.setAttribute("data-field",e),i.appendChild(t),t.appendChild(l);let n=document.createElement("div");n.className="controls",n.setAttribute("data-field",e);let a=document.createElement("button");a.className="delete btn btn-danger",a.innerHTML="Delete",n.appendChild(a);let s=document.createElement("input");s.className="search form-control",s.placeholder="Search";let o=document.createElement("input");o.className="replace form-control",o.placeholder="Replace",n.appendChild(s),n.appendChild(o);let d=document.createElement("button");d.className="icon btn btn-light",d.innerHTML="◀";let c=document.createElement("button");c.className="icon btn btn-light",c.innerHTML="▶",n.appendChild(d),n.appendChild(c),t.appendChild(n);let h=e=>{let t=this.fields.indexOf(e);this.deleteField(e),i.children[t].remove(),[].slice.call(r.children).map(e=>{e.children[t].remove()})},p=(e,t)=>{if(!t.length)return u(),!1;let i=[].slice.call(r.children),l=this.fields.indexOf(e);i.map(e=>{let i=e.children[l],n=i.children[0].value.match(new RegExp(t));i.classList.remove("match"),n&&i.classList.add("match")})},u=()=>{[].slice.call(document.querySelectorAll(".match")).map(e=>e.classList.remove("match"))},f=(e,t,i)=>{this.replaceValues(e,t,i),this.reloadTable()},g=e=>{let l=this.fields.indexOf(e),n=l-1>0?l-1:0;this.fields.splice(l,1),this.fields.splice(n,0,e),i.insertBefore(t,i.children[n]),this.reloadTable()},m=e=>{let l=this.fields.indexOf(e),n=l+1<this.fields.length?l+1:l;this.fields.splice(l,1),this.fields.splice(n,0,e),i.insertBefore(t,i.children[n+1]),this.reloadTable()};s.addEventListener("keyup",e=>{p(e.target.parentElement.getAttribute("data-field"),e.target.value)}),s.addEventListener("focus",e=>{p(e.target.parentElement.getAttribute("data-field"),e.target.value)}),s.addEventListener("blur",u),o.addEventListener("focus",e=>{p(e.target.parentElement.getAttribute("data-field"),e.target.parentElement.querySelector(".search").value)}),o.addEventListener("blur",u),o.addEventListener("keyup",e=>{"Enter"==e.key&&f(e.target.parentElement.getAttribute("data-field"),e.target.parentElement.querySelector(".search").value,e.target.value)}),d.addEventListener("click",e=>{g(e.target.parentElement.getAttribute("data-field"))}),c.addEventListener("click",e=>{m(e.target.parentElement.getAttribute("data-field"))}),a.addEventListener("click",e=>{h(e.target.parentElement.getAttribute("data-field"))}),l.addEventListener("keyup",e=>{"Enter"==e.key&&e.target.blur()}),l.addEventListener("blur",e=>{e.target.classList.remove("is-invalid"),this.fields.includes(e.target.value)?e.target.getAttribute("data-field")!=e.target.value&&e.target.classList.add("is-invalid"):(this.renameField(e.target.getAttribute("data-field"),e.target.value),l.setAttribute("data-field",e.target.value),l.parentElement.querySelector(".controls").setAttribute("data-field",e.target.value))})};return this.fields.map(e=>{s(e)}),e}reloadTable(){this.clearTable(),this.loadRows()}clearTable(){let e=document.querySelector("table.tabler tbody");e&&(e.innerHTML="")}loadRows(e,t){this.clearTable(),e=parseInt(e)||this.config.offset,t=parseInt(t)||this.config.limit;for(var i=e;i<e+t;i++)i>0&&i<this.rows.length&&this.appendRow(i);this.config.offset=e,this.config.limit=t}appendRow(e){var t=this.rows[e],i=document.createElement("tr");let l=document.querySelector("table.tabler tbody");i.setAttribute("data-row",e),l.appendChild(i),this.fields.map(e=>{let l=document.createElement("td"),n=document.createElement("input");n.classList.add("form-control"),n.value=t[e],n.setAttribute("data-field",e),i.appendChild(l),l.appendChild(n),n.addEventListener("keyup",e=>{let t=e.target.parentElement.parentElement.getAttribute("data-row"),i=e.target.getAttribute("data-field");this.rows[t][i]=e.target.value})})}export(){let e="";return this.fields.map((t,i)=>{e+=t,i<this.fields.length-1&&(e+=this.config.separator)}),e+=this.config.eol,this.rows.map(t=>{this.fields.map((i,l)=>{e+=t[i],l<this.fields.length-1&&(e+=this.config.separator)}),e+=this.config.eol}),e}json(){return JSON.stringify(this.rows)}}({data:e}),i=inputFile.files[inputFile.files.length-1];fileName.innerHTML=i.name,fileSize.innerHTML="("+(e=>{let t=e+"o";return(e+"").length>3&&(t=Math.round(e/100)/10+"ko"),(e+"").length>6&&(t=Math.round(e/1e5)/10+"mo"),(e+"").length>9&&(t=Math.round(e/1e8)/10+"go"),t})(i.size)+")",rowCount.innerHTML=t.rows.length+" rows",separator.innerHTML=t.config.separator,exports.innerHTML="";let l=document.createElement("button");l.className="btn btn-primary m-2",l.innerHTML=".csv",l.addEventListener("click",()=>{console.log(t.export())}),exports.appendChild(l);let n=document.createElement("button");n.className="btn btn-primary m-2",n.innerHTML=".json",n.addEventListener("click",()=>{console.log(t.json())}),exports.appendChild(n),offset.value=t.config.offset,limit.value=t.config.limit,offset.addEventListener("keyup",e=>{if("Enter"!=e.key)return!1;t.clearTable(),t.loadRows(offset.value,limit.value)}),limit.addEventListener("keyup",e=>{if("Enter"!=e.key)return!1;t.clearTable(),t.loadRows(offset.value,limit.value)}),prev.addEventListener("click",()=>{let e=parseInt(offset.value),i=parseInt(limit.value);e-i>=0&&(offset.value=e-i),t.clearTable(),t.loadRows(offset.value,limit.value)}),next.addEventListener("click",()=>{let e=parseInt(offset.value),i=parseInt(limit.value);e+i<t.rows.length&&(offset.value=e+i),t.clearTable(),t.loadRows(e,i)});let a=t.htmlController();htmlArrayResult.innerHTML="",htmlArrayResult.appendChild(a),t.loadRows(),display.classList.remove("invisible")})})}]);